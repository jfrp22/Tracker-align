<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acerca de - Nodo IoT Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/config.css">
    <link rel="stylesheet" href="css/about.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-microchip"></i> Nodo IoT Tracker</h1>
            <p class="subtitle">Sistema avanzado de geolocalización, orientación y gestión remota</p>
        </header>
        
        <nav>
            <a href="main.html"><i class="fas fa-home"></i> Inicio</a>
            <a href="gps.html"><i class="fas fa-map-marked-alt"></i> Tracker GPS</a>
            <a href="config.html"><i class="fas fa-network-wired"></i> Configuración</a>
            <a href="control.html"><i class="fas fa-cog"></i> CMA</a>
            <a href="about.html" class="active"><i class="fas fa-info-circle"></i> Acerca de</a>
            <a href="contact.html"><i class="fas fa-envelope"></i> Contacto</a>
        </nav>
        
        <div class="about-card">
            <section class="project-description">
                <h2><i class="fas fa-project-diagram"></i> Descripción del Proyecto</h2>
                <p>Este proyecto implementa un nodo IoT basado en ESP8266 con funcionalidades avanzadas de conectividad, geolocalización, orientación y gestión remota. Combina hardware (GPS, WiFi, IMU, magnetómetro, servomotores) y software (servidor web, MQTT, OTA) para crear un sistema escalable y configurable para aplicaciones de apuntamiento y seguimiento.</p>
            </section>

            <section class="components">
                <h2><i class="fas fa-puzzle-piece"></i> Componentes Clave</h2>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Hardware</h3>
                        <ul>
                            <li><strong>ESP8266:</strong> Microcontrolador con WiFi integrado (80MHz, 4MB Flash)</li>
                            <li><strong>Módulo GPS (ej. NEO-6M):</strong> Proporciona datos de ubicación (latitud, longitud, altitud) mediante comunicación serial (pines D3-RX, D4-TX)</li>
                            <li><strong>Módulo IMU MPU6050:</strong> Proporciona datos de aceleración lineal y velocidad angular (giroscopio y acelerómetro) vía I2C</li>
                            <li><strong>Magnetómetro QMC5883L:</strong> Proporciona datos del campo magnético para cálculo del heading (rumbo) vía I2C</li>
                            <li><strong>Servomotores de 360° (x2):</strong> Control de azimut (D7) y elevación (D6) para sistemas de apuntamiento</li>
                            <li><strong>Botón físico (D5):</strong> Para reset de configuración (3 segundos) o reset de fábrica (8 segundos)</li>
                            <li><strong>LED de estado (D8):</strong> Indicador visual del estado del sistema</li>
                        </ul>
                    </div>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Software</h3>
                        <h4>Protocolos:</h4>
                        <ul>
                            <li><strong>WiFi:</strong> Conexión a redes locales o modo AP (punto de acceso: IoTNode-AP/config1234)</li>
                            <li><strong>MQTT:</strong> Comunicación con brokers públicos (Mosquitto, HiveMQ, EMQX) para mensajería lightweight</li>
                            <li><strong>mDNS:</strong> Resolución de nombres en red local (hostname: antenna)</li>
                            <li><strong>HTTP/Webserver Async:</strong> Servidor web asíncrono con autenticación (admin/iotlab123)</li>
                            <li><strong>OTA:</strong> Actualizaciones Over-The-Air con autenticación</li>
                        </ul>
                        <h4>Librerías:</h4>
                        <ul>
                            <li><strong>TinyGPS++</strong> (procesamiento GPS)</li>
                            <li><strong>PubSubClient</strong> (MQTT)</li>
                            <li><strong>ESPAsyncWebServer/ESPAsyncTCP</strong> (servidor web asíncrono)</li>
                            <li><strong>ArduinoOTA</strong> (actualizaciones inalámbricas)</li>
                            <li><strong>MPU6050</strong> (gestión del sensor IMU)</li>
                            <li><strong>Servo</strong> (control de servomotores)</li>
                            <li><strong>ArduinoJson</strong> (manejo de datos JSON)</li>
                            <li><strong>Ticker</strong> (temporizadores no bloqueantes)</li>
                            <li><strong>SoftwareSerial</strong> (comunicación serial con GPS)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="features">
                <h2><i class="fas fa-cogs"></i> Funcionalidades Principales</h2>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-sliders-h"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Configuración Flexible</h3>
                        <h4>Modos de Operación:</h4>
                        <ul>
                            <li><strong>WiFi Client:</strong> Conecta a redes guardadas en EEPROM</li>
                            <li><strong>Modo AP:</strong> Si no hay credenciales WiFi, crea una red (IoTNode-AP) para configuración</li>
                        </ul>
                        <h4>Interfaz Web:</h4>
                        <ul>
                            <li>Dashboard con autenticación (admin/iotlab123, configurables)</li>
                            <li>Páginas para:
                                <ul>
                                    <li>Configurar WiFi (SSID/contraseña)</li>
                                    <li>Definir el rol del nodo (MASTER, SLAVE, UNCONFIGURED)</li>
                                    <li>Emparejar nodos (ej.: esclavos con un maestro)</li>
                                    <li>Control manual de servos (azimut y elevación)</li>
                                    <li>Calibración de brújula y heading</li>
                                    <li>Configuración de coordenadas manuales/GPS</li>
                                    <li>Configuración de objetivo de apuntamiento</li>
                                    <li>Gestión de credenciales de acceso web</li>
                                    <li>Reinicio de fábrica (borra EEPROM completa)</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Comunicación MQTT</h3>
                        <h4>Brokers Soportados (con rotación automática):</h4>
                        <pre>const char* mqtt_servers[] = {
  "test.mosquitto.org", 
  "broker.hivemq.com", 
  "broker.emqx.io"
};</pre>
                        <h4>Tópicos Clave:</h4>
                        <ul>
                            <li><strong>iotlab/nodes/status:</strong> Publica estado del nodo (IP, RSSI, rol, emparejamiento)</li>
                            <li><strong>iotlab/gps/data:</strong> Envía coordenadas GPS con filtrado de mediana</li>
                            <li><strong>iotlab/sensor/data:</strong> Datos de IMU, heading y estado de servos</li>
                            <li><strong>iotlab/servo/control:</strong> Control remoto de servomotores</li>
                            <li><strong>iotlab/nodes/config:</strong> Recibe comandos para cambiar rol o emparejar</li>
                            <li><strong>iotlab/pairing/request:</strong> Solicitudes de emparejamiento (para maestros)</li>
                            <li><strong>iotlab/pairing/response:</strong> Respuestas de emparejamiento</li>
                            <li><strong>iotlab/pairing/unpair_request:</strong> Solicitudes de desemparejamiento</li>
                            <li><strong>iotlab/pairing/unpair_confirm:</strong> Confirmaciones de desemparejamiento</li>
                            <li><strong>iotlab/master/{MAC}/broadcast:</strong> Comunicación maestro-esclavo</li>
                            <li><strong>iotlab/master/{MAC}/request:</strong> Solicitudes de esclavos a maestros</li>
                            <li><strong>iotlab/nodes/{MAC}/distance:</strong> Publicación de distancias entre nodos</li>
                        </ul>
                    </div>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-sitemap"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Roles y Jerarquía</h3>
                        <ul>
                            <li><strong>MASTER:</strong>
                                <ul>
                                    <li>Gestiona múltiples esclavos (lista separada por comas en pairedDevice)</li>
                                    <li>Envía broadcasts periódicos a esclavos con sus coordenadas</li>
                                    <li>Recibe y responde solicitudes de emparejamiento</li>
                                    <li>Gestiona solicitudes de desemparejamiento</li>
                                    <li>Puede tener múltiples esclavos emparejados simultáneamente</li>
                                </ul>
                            </li>
                            <li><strong>SLAVE:</strong>
                                <ul>
                                    <li>Se suscribe al tópico de broadcast de su maestro</li>
                                    <li>Responde a comandos remotos y actualizaciones de coordenadas</li>
                                    <li>Calcula y publica distancia al maestro</li>
                                    <li>Solo puede estar emparejado con un maestro a la vez</li>
                                    <li>Puede solicitar desemparejamiento mediante MQTT</li>
                                    <li>Soporta modo de alineamiento automático con el maestro</li>
                                </ul>
                            </li>
                            <li><strong>UNCONFIGURED:</strong> Esperando configuración inicial (rol y emparejamiento)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Geolocalización y Orientación</h3>
                        <h4>Procesamiento GPS Avanzado:</h4>
                        <ul>
                            <li>Lectura continua de datos NMEA con TinyGPS++</li>
                            <li>Filtro de mediana de 5 muestras para suavizado de datos de posición</li>
                            <li>Validación de datos GPS con timeout de 2 segundos</li>
                            <li>Publicación periódica (cada 5s) de datos GPS cuando están disponibles</li>
                            <li>Estructura de datos GPS publicada:
                                <pre>{
  "mac": "ABC123",
  "lat": 12.345678,
  "lng": -98.765432,
  "alt": 250.5,
  "sats": 8,
  "time": 1234567890
}</pre>
                            </li>
                        </ul>
                        
                        <h4>Orientación y Apuntamiento Avanzado:</h4>
                        <ul>
                            <li>Cálculo de pitch, roll a partir del MPU6050 (fusión acelerómetro/giroscopio)</li>
                            <li>Determinación del heading (rumbo) mediante magnetómetro QMC5883L con corrección de declinación magnética (-12°)</li>
                            <li>Sistema de calibración de heading inicial (promedio de 10 lecturas)</li>
                            <li>Offset de heading configurable para corrección manual</li>
                            <li>Límites de movimiento para azimut (±55°) y elevación (65°-115°) con márgenes de seguridad</li>
                            <li>Control de servos con verificación de límites en tiempo real (cada 50ms)</li>
                            <li>Apuntamiento automático a coordenadas objetivo (hasTarget)</li>
                            <li>Cálculo preciso de bearing y distancia a objetivo (fórmula Haversine)</li>
                            <li>Control de elevación basado en distancia al objetivo con ángulos óptimos configurables</li>
                            <li>Interfaz web en tiempo real con visualización de datos de sensores y estado de servos</li>
                        </ul>
                    </div>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Actualizaciones OTA (Over-The-Air)</h3>
                        <ul>
                            <li>Actualización inalámbrica del firmware mediante ArduinoOTA</li>
                            <li>Autenticación con contraseña (admin por defecto)</li>
                            <li>Indicación visual mediante LED durante el proceso</li>
                            <li>Reinicio automático tras actualización exitosa</li>
                            <li>Hostname personalizado (antenna-{MAC})</li>
                            <li>Manejo de errores con callbacks para diferentes tipos de fallos</li>
                        </ul>
                    </div>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Persistencia y Robustez</h3>
                        <ul>
                            <li><strong>EEPROM (512 bytes):</strong>
                                <ul>
                                    <li>Almacena configuración crítica (WiFi, rol, emparejamiento, credenciales web)</li>
                                    <li>Guarda heading inicial y offset de calibración</li>
                                    <li>Soporta reinicios sin pérdida de datos</li>
                                    <li>Verificación de borrado completo en reset de fábrica</li>
                                    <li>Estructura de datos definida:
                                        <pre>struct {
  char wifiSSID[32];
  char wifiPass[32];
  char nodeRole[16];
  char pairedDevice[64];
  float headingInicial;
  float headingOffset;
  char httpUser[16];
  char httpPass[16];
} eepromConfig;</pre>
                                    </li>
                                </ul>
                            </li>
                            <li><strong>Mecanismos de Recuperación:</strong>
                                <ul>
                                    <li>Reintentos de conexión WiFi/MQTT con rotación automática de brokers</li>
                                    <li>Temporizadores no bloqueantes (Ticker) para todas las tareas periódicas</li>
                                    <li>Reset por hardware (botón físico con detección debounced)</li>
                                    <li>Reset de configuración (3 segundos) y de fábrica (8 segundos)</li>
                                    <li>Verificación de borrado completo de EEPROM en reset de fábrica</li>
                                    <li>Sistema de reintentos para conexión MQTT con contador de intentos</li>
                                </ul>
                            </li>
                            <li><strong>Protección de Hardware:</strong>
                                <ul>
                                    <li>Límites software para evitar daños mecánicos en servos</li>
                                    <li>Detención de emergencia de servos (detenerServosEmergency)</li>
                                    <li>Sistema de histéresis para evitar oscilaciones en límites</li>
                                    <li>Verificación de límites en tiempo real para ambos servos</li>
                                    <li>Comprobación de permisos de movimiento antes de ejecutar comandos</li>
                                    <li>Márgenes de seguridad para evitar alcanzar límites físicos</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="feature">
                    <div class="feature-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="feature-text">
                        <h3>Alineamiento Automático</h3>
                        <ul>
                            <li><strong>Activación/Desactivación:</strong> Mediante interfaz web o comandos MQTT</li>
                            <li><strong>Funcionamiento para esclavos:</strong>
                                <ul>
                                    <li>Recibe coordenadas del maestro mediante MQTT</li>
                                    <li>Calcula bearing y distancia hacia el maestro</li>
                                    <li>Ajusta azimut y elevación automáticamente</li>
                                    <li>Publica distancia calculada en tópico específico</li>
                                </ul>
                            </li>
                            <li><strong>Funcionamiento para maestros:</strong>
                                <ul>
                                    <li>Envía coordenadas a esclavos periódicamente</li>
                                    <li>Puede recibir solicitudes de alineamiento de esclavos</li>
                                </ul>
                            </li>
                            <li><strong>Actualización en tiempo real:</strong> Cada 2 segundos o cuando cambian las coordenadas</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="pinout">
                <h2><i class="fas fa-microchip"></i> Pinout y Conectividad</h2>
                <div class="pinout-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Pin ESP8266</th>
                                <th>Función</th>
                                <th>Componente</th>
                                <th>Notas</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>D3</td>
                                <td>GPIO0 (RX)</td>
                                <td>GPS</td>
                                <td>Recepción de datos GPS (SoftwareSerial)</td>
                            </tr>
                            <tr>
                                <td>D4</td>
                                <td>GPIO2 (TX)</td>
                                <td>GPS</td>
                                <td>Transmisión al GPS (SoftwareSerial)</td>
                            </tr>
                            <tr>
                                <td>D5</td>
                                <td>GPIO14</td>
                                <td>Botón físico</td>
                                <td>Entrada, reset de configuración/fábrica</td>
                            </tr>
                            <tr>
                                <td>D6</td>
                                <td>GPIO12</td>
                                <td>Servo Elevación</td>
                                <td>Salida PWM, control de elevación (65°-115°)</td>
                            </tr>
                            <tr>
                                <td>D7</td>
                                <td>GPIO13</td>
                                <td>Servo Azimut</td>
                                <td>Salida PWM, control de azimut (±55°)</td>
                            </tr>
                            <tr>
                                <td>D8</td>
                                <td>GPIO15</td>
                                <td>LED de estado</td>
                                <td>Salida, indicador visual del estado del sistema</td>
                            </tr>
                            <tr>
                                <td>D1</td>
                                <td>GPIO5 (SCL)</td>
                                <td>I2C</td>
                                <td>Reloj I2C para IMU y magnetómetro</td>
                            </tr>
                            <tr>
                                <td>D2</td>
                                <td>GPIO4 (SDA)</td>
                                <td>I2C</td>
                                <td>Datos I2C para IMU y magnetómetro</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="commands">
                <h2><i class="fas fa-terminal"></i> Comandos y Estructuras</h2>
                
                <h3>Comandos MQTT</h3>
                <div class="commands-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Comando</th>
                                <th>Tópico</th>
                                <th>Payload (JSON)</th>
                                <th>Descripción</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Control de Servos</td>
                                <td>iotlab/servo/control</td>
                                <td><pre>{
  "target": "ABC123",
  "command": "servo_control",
  "servo": "A",
  "action": "left"
}</pre></td>
                                <td>Control remoto de servos (left, right, up, down, stop)</td>
                            </tr>
                            <tr>
                                <td>Configuración de Rol</td>
                                <td>iotlab/nodes/config</td>
                                <td><pre>{
  "target": "ABC123",
  "role": "MASTER",
  "pair_with": ""
}</pre></td>
                                <td>Cambiar rol del nodo (MASTER/SLAVE/UNCONFIGURED)</td>
                            </tr>
                            <tr>
                                <td>Solicitud de Emparejamiento</td>
                                <td>iotlab/pairing/request</td>
                                <td><pre>{
  "master_mac": "MASTER_MAC",
  "slave_mac": "SLAVE_MAC"
}</pre></td>
                                <td>Solicitud de emparejamiento entre nodos</td>
                            </tr>
                            <tr>
                                <td>Respuesta de Emparejamiento</td>
                                <td>iotlab/pairing/response</td>
                                <td><pre>{
  "master_mac": "MASTER_MAC",
  "slave_mac": "SLAVE_MAC",
  "status": "PAIRED"
}</pre></td>
                                <td>Respuesta a solicitud de emparejamiento</td>
                            </tr>
                            <tr>
                                <td>Solicitud de Desemparejamiento</td>
                                <td>iotlab/pairing/unpair_request</td>
                                <td><pre>{
  "master_mac": "MASTER_MAC",
  "slave_mac": "SLAVE_MAC"
}</pre></td>
                                <td>Solicitud para deshacer emparejamiento</td>
                            </tr>
                            <tr>
                                <td>Confirmación de Desemparejamiento</td>
                                <td>iotlab/pairing/unpair_confirm</td>
                                <td><pre>{
  "status": "OK",
  "slave_mac": "SLAVE_MAC"
}</pre></td>
                                <td>Confirmación de desemparejamiento</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Estructuras de Datos</h3>
                <div class="data-structures">
                    <h4>Datos GPS</h4>
                    <pre>struct GpsData {
  float latitude;
  float longitude;
  float altitude;
  int satellites;
  unsigned long age;
  bool valid;
};</pre>
                    
                    <h4>Datos de Orientación</h4>
                    <pre>struct OrientationData {
  float pitch;
  float roll;
  float yaw;
  float heading;
  float headingCorrected;
  float x_gauss;
  float y_gauss;
  float z_gauss;
};</pre>
                    
                    <h4>Estado del Sistema</h4>
                    <pre>struct SystemStatus {
  String nodeID;
  String nodeRole;
  String pairedDevice;
  bool hasTarget;
  bool autoAlignmentActive;
  bool commsActive;
  int servoA_dir;
  int servoB_dir;
};</pre>
                </div>
            </section>

            <section class="technical-specs">
                <h2><i class="fas fa-tools"></i> Especificaciones Técnicas</h2>
                <div class="specs-grid">
                    <div class="spec-item">
                        <h3><i class="fas fa-microchip"></i> Microcontrolador</h3>
                        <p>ESP8266 con WiFi integrado</p>
                    </div>
                    <div class="spec-item">
                        <h3><i class="fas fa-satellite"></i> GPS</h3>
                        <p>Módulo NEO-6M con interfaz serial</p>
                    </div>
                    <div class="spec-item">
                        <h3><i class="fas fa-compass"></i> Sensores IMU</h3>
                        <p>MPU6050 (acelerómetro/giroscopio) + QMC5883L (magnetómetro)</p>
                    </div>
                    <div class="spec-item">
                        <h3><i class="fas fa-cogs"></i> Servos</h3>
                        <p>2x Servos de 360° para control de azimut y elevación</p>
                    </div>
                    <div class="spec-item">
                        <h3><i class="fas fa-database"></i> Almacenamiento</h3>
                        <p>EEPROM interna (512 bytes) para configuración persistente</p>
                    </div>
                    <div class="spec-item">
                        <h3><i class="fas fa-network-wired"></i> Conectividad</h3>
                        <p>WiFi 802.11 b/g/n, modo cliente y AP</p>
                    </div>
                    <div class="spec-item">
                        <h3><i class="fas fa-cloud"></i> Protocolos</h3>
                        <p>MQTT, HTTP, OTA</p>
                    </div>
                    <div class="spec-item">
                        <h3><i class="fas fa-bolt"></i> Alimentación</h3>
                        <p>5V DC mediante USB o fuente externa</p>
                    </div>
                </div>
            </section>
        </div>
    </div>
</body>
</html>
